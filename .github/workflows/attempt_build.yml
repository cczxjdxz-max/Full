name: 1. Attempt to Build (Self-Healing)

on:
  repository_dispatch:
    types: [execute_task]
  workflow_dispatch:

jobs:
  perform_task:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: "Main Mission"
        run: |
          # الأوامر الحالية (تحميل اللعبة وتفكيكها)
          curl -L -o game.apk "[https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk](https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk)"
          apktool d game.apk --force
          
      - name: "On Failure: Signal Brain"
        if: failure()
        run: |
          # إرسال تقرير الفشل للقائد ليقوم جيمني بالتعديل
          curl -L -X POST -H "Authorization: Bearer ${{ secrets.PAT }}" \
          [https://api.github.com/repos/cczxjdxz-max/avatar-template/dispatches](https://api.github.com/repos/cczxjdxz-max/avatar-template/dispatches) \
          -d "{\"event_type\": \"executor_failed\", \"client_payload\": {\"step\": \"dissection\", \"log\": \"failed to decompile apk\"}}"