name: 1. AI Pro-Hunter (Build APK)

on:
  repository_dispatch:
    types: [execute_task]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: "Checkout"
        uses: actions/checkout@v4

      - name: "Setup Python & Build Tools"
        run: |
          sudo apt-get update
          sudo apt-get install -y python3-pip build-essential git ffmpeg libsdl2-dev
          pip install buildozer cython torch numpy

      - name: "Execute Gemini Command"
        env:
          COMMANDS: ${{ github.event.client_payload.commands }}
        run: |
          # تنفيذ الأوامر (بناء العقل، الشخصية، الواجهة)
          eval "$COMMANDS"

      - name: "Clean & Push Results"
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "AI-Pro-Hunter"
          # تجاهل المجلدات الضخمة تماماً
          echo "venv/" > .gitignore
          echo ".buildozer/" >> .gitignore
          echo "bin/" >> .gitignore
          
          git add .gitignore hunter_logic.py arrogant_brain.py ai_model.py main.py
          git commit -m "Gemini: Deploying Arrogant Personality Core" || echo "No changes"
          git push