name: 2. The Executor - Construct Pure APK
on:
  repository_dispatch:
    types: [build_empty_apk]

permissions:
  contents: write

jobs:
  assemble_pure_body:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“‚ Checkout Repo
        uses: actions/checkout@v4

      - name: â˜• Setup Java 17
        uses: actions/setup-java@v4
        with:
          distribution: 'zulu'
          java-version: '17'

      - name: ğŸ—ï¸ Create Android Structure (If missing)
        run: |
          # Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¨Ù†Ø§Ø¡
          mkdir -p app/src/main/res/layout
          mkdir -p app/src/main/java/com/decapitator/ai

          # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Gradle Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
          cat <<EOF > build.gradle
          buildscript {
              repositories { google(); mavenCentral() }
              dependencies { classpath 'com.android.tools.build:gradle:8.1.1' }
          }
          allprojects {
              repositories { google(); mavenCentral() }
          }
          EOF

          # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
          cat <<EOF > app/build.gradle
          plugins { id 'com.android.application' }
          android {
              namespace 'com.decapitator.ai'
              compileSdk 33
              defaultConfig {
                  applicationId "com.decapitator.ai"
                  minSdk 24
                  targetSdk 33
                  versionCode 1
                  versionName "1.0"
              }
          }
          EOF

      - name: ğŸ”¨ Assemble Debug APK
        run: |
          # Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
          gradle assembleDebug

      - name: ğŸ“¦ Archive APK
        run: |
          mkdir -p final_output
          cp app/build/outputs/apk/debug/app-debug.apk final_output/Decapitator_Pure_Body.apk

      - name: ğŸš€ Release to GitHub
        uses: softprops/action-gh-release@v1
        with:
          files: final_output/Decapitator_Pure_Body.apk
          name: "The Decapitator - Pure Body v1.0"
          tag_name: "v1.0-pure"
          body: "ØªÙ… Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ø³Ø¯ (APK) Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¬Ø§Ù‡Ø²Ø© ÙˆØ¨Ø§Ù†ØªØ¸Ø§Ø± Ø­Ù‚Ù† Ø§Ù„Ø¹Ù‚Ù„."
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}