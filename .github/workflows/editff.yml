name: GIAS-INTELLIGENT-RADAR
on:
  workflow_dispatch:

jobs:
  analyze:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup & Extraction
        run: |
          pip install UnityPy
          wget -q -O game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          unzip -o game.apk -d game_files

      - name: 2. Smart Search & Clean Script
        run: |
          cat << 'EOF' > radar.py
          import UnityPy
          import json
          import os

          # Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ø¨Ø­Ø« Ø¹Ù†Ù‡Ø§ ÙÙŠ "Ø§Ù„Ù…Ù†Ø¬Ù…"
          keywords = ["bermuda", "physics", "weapon", "recoil", "bullet", "gloo", "terrain"]
          found_gems = []

          target_dir = ""
          for root, dirs, files in os.walk("game_files"):
              if root.endswith("bin"):
                  target_dir = root
                  break

          print(f"ğŸ“¡ Radar scanning 30K files in {target_dir}...")

          for root, dirs, files in os.walk(target_dir):
              for file in files:
                  file_path = os.path.join(root, file)
                  if os.path.getsize(file_path) < 10240: continue
                      
                  try:
                      env = UnityPy.load(file_path)
                      for obj in env.objects:
                          if obj.type.name in ["MonoBehaviour", "Mesh"]:
                              data = obj.read()
                              name = getattr(data, 'name', '').lower()
                              
                              # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø°Ù‡Ø¨ ÙˆØ³Ø· Ø§Ù„Ù‡ÙˆØ§Ø¡
                              if any(k in name for k in keywords):
                                  found_gems.append({
                                      "target_name": name,
                                      "encrypted_file": file,
                                      "type": obj.type.name,
                                      "data_size": obj.size
                                  })
                  except:
                      continue

          # ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ø£ÙƒØ¨Ø± ØºØ§Ù„Ø¨Ø§Ù‹ Ù‡Ùˆ Ø§Ù„Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©)
          found_gems.sort(key=lambda x: x['data_size'], reverse=True)

          # Ø­ÙØ¸ Ø£Ù‡Ù… 20 Ù†ØªÙŠØ¬Ø© ÙÙ‚Ø· (Ø§Ù„Ø²Ø¨Ø¯Ø©)
          with open("top_priority_assets.json", "w", encoding='utf-8') as f:
              json.dump(found_gems[:20], f, indent=4)
          
          print(f"âœ… Radar found {len(found_gems)} potential targets!")
          EOF
          python3 radar.py

      - name: 3. Show Results in Logs
        run: |
          echo "--- TOP 10 DATA GEMS FOUND ---"
          head -n 50 top_priority_assets.json