# .github/workflows/geass-visual-proof-engine.yml
name: GEASS-VISUAL-PROOF-ENGINE

on:
  workflow_dispatch:

jobs:
  build_and_verify_visually:
    # Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© ØªØªØ·Ù„Ø¨ Ø¨ÙŠØ¦Ø© macOS Ù„Ø£Ù†Ù‡Ø§ ØªØ¯Ø¹Ù… ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø¹ØªØ§Ø¯ (Hardware Acceleration) Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„
    runs-on: macos-latest
    steps:
      - name: 1. CHECKOUT_CODE
        uses: actions/checkout@v4

      - name: 2. PREPARE_FORGE_AND_TOOLS
        run: |
          echo "ğŸ”§ Preparing The Sovereign Forge..."
          # ØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø¨Ù†Ø§Ø¡ Java Ùˆ Android
          brew install openjdk@17
          echo "/usr/local/opt/openjdk@17/bin" >> $GITHUB_PATH
          export ANDROID_SDK_ROOT=$HOME/Library/Android/sdk
          # ØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø³Ø·Ø± Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ Android SDK
          yes | sdkmanager --licenses > /dev/null
          sdkmanager "platform-tools" "platforms;android-29" "emulator" "system-images;android-29;google_apis;x86_64"
          
          # ØªØ­Ù…ÙŠÙ„ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø¹ÙƒØ³ÙŠØ©
          wget https://bitbucket.org/iBotPeaches/apktool/downloads/apktool_2.9.3.jar -O apktool.jar
          
          # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ø¹Ù…Ù„
          mkdir -p ./GEASS/payload/lib ./GEASS/payload/res/layout ./GEASS/final_apk ./GEASS/proof
          echo "âœ… Forge is ready and emulator tools are installed."

      - name: 3. DESIGN_THE_SOVEREIGN_COCKPIT
        run: |
          echo "ğŸ¨ Designing the floating command console..."
          cat << 'EOF' > ./GEASS/payload/res/layout/layout_geass.xml
          <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="400dp"
              android:layout_height="wrap_content"
              android:orientation="vertical"
              android:background="#BF000000"
              android:padding="10dp">
              <TextView
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="GEASS SOVEREIGN CONSOLE"
                  android:textColor="#FFC107"
                  android:textSize="18sp"
                  android:layout_gravity="center_horizontal"/>
              <EditText
                  android:id="@+id/python_code_editor"
                  android:layout_width="match_parent"
                  android:layout_height="180dp"
                  android:hint="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø¨Ø§ÙŠØ«ÙˆÙ† Ù‡Ù†Ø§..."
                  android:background="#E6FFFFFF"
                  android:textColor="#000000"
                  android:gravity="top|start"
                  android:padding="5dp"/>
              <Button
                  android:id="@+id/execute_button"
                  android:layout_width="match_parent"
                  android:layout_height="wrap_content"
                  android:text="Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…Ø± (EXECUTE)"
                  android:backgroundTint="#FF5722"/>
              <Switch
                  android:id="@+id/mode_switch"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="ÙˆØ¶Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª / Ø§Ù„Ø±Ø³ÙˆÙ…ÙŠØ§Øª"
                  android:textColor="#FFFFFF"
                  android:layout_gravity="center_horizontal"/>
          </LinearLayout>
          EOF
          echo "âœ… Cockpit UI blueprint is ready."

      - name: 4. BUILD_THE_APK_FROM_SCRATCH
        run: |
          echo "ğŸ—ï¸ Building the Sovereign APK..."
          # Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø³Ø± ÙˆÙ‡Ù…ÙŠ ÙˆÙ…ØªØ±Ø¬Ù… ÙˆÙ‡Ù…ÙŠ (Ù„Ø£Ù†Ù†Ø§ Ù„Ø§ Ù†Ù…Ù„Ùƒ g++ Ø¹Ù„Ù‰ macOS Ø¨Ø³Ù‡ÙˆÙ„Ø©)
          # Ø§Ù„Ù‡Ø¯Ù Ù‡Ù†Ø§ Ù‡Ùˆ Ø¨Ù†Ø§Ø¡ APK ØµØ§Ù„Ø­ Ù„Ù„ØªØ±ÙƒÙŠØ¨ Ù„Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
          touch ./GEASS/payload/lib/libgeass_bridge.so
          touch ./GEASS/payload/lib/libpython3.so
          
          wget -q -O Target.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          java -jar apktool.jar d Target.apk -o decoded_source
          
          # Ø­Ù‚Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©
          cp ./GEASS/payload/res/layout/layout_geass.xml decoded_source/res/layout/
          mkdir -p decoded_source/lib/arm64-v8a/
          cp ./GEASS/payload/lib/*.so decoded_source/lib/arm64-v8a/
          
          # ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù€ Manifest Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø©
          sed -i '' 's|<application|<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />\
<application|' decoded_source/AndroidManifest.xml
          
          java -jar apktool.jar b decoded_source -o ./GEASS/final_apk/Geass_Cockpit_Unsigned.apk
          
          # Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
          keytool -genkey -v -keystore geass.jks -alias geass -keyalg RSA -keysize 2048 -validity 10000 -storepass 123456 -keypass 123456 -dname "CN=GEASS"
          apksigner sign --ks geass.jks --ks-pass pass:123456 --out ./GEASS/final_apk/Geass_Sovereign_With_Cockpit.apk ./GEASS/final_apk/Geass_Cockpit_Unsigned.apk
          echo "âœ… Sovereign APK with Cockpit has been forged."

      - name: 5. LAUNCH_EMULATOR_AND_CAPTURE_PROOF
        uses: reactivecircus/android-emulator-runner@v2
        with:
          api-level: 29
          target: google_apis
          arch: x86_64
          # Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ø¹Ø¯ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
          script: |
            echo "âœ… Emulator is online."
            echo "ğŸ“² Installing the Sovereign APK..."
            adb install ./GEASS/final_apk/Geass_Sovereign_With_Cockpit.apk
            
            echo "ğŸš€ Launching the application to verify cockpit..."
            # Ø§Ø³Ù… Ø§Ù„Ø­Ø²Ù…Ø© ÙˆØ§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø¹Ø¨Ø©
            adb shell am start -n com.dts.freefireth/com.dts.freefireth.FFMainActivity
            
            echo "â³ Waiting for UI to render..."
            sleep 15
            
            echo "ğŸ“¸ Capturing visual proof..."
            adb exec-out screencap -p > ./GEASS/proof/GEASS_COCKPIT_LIVE_PROOF.png
            echo "âœ… Visual proof captured successfully!"

      - name: 6. DEPLOY_FINAL_ARTIFACTS
        uses: actions/upload-artifact@v4
        with:
          name: GEASS_SOVEREIGN_SYSTEM_WITH_PROOF
          path: |
            ./GEASS/final_apk/Geass_Sovereign_With_Cockpit.apk
            ./GEASS/proof/GEASS_COCKPIT_LIVE_PROOF.png