name: GIAS-THE-OMNI-ARCHIVE

on:
  workflow_dispatch:

jobs:
  everything_extractor:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup Environment
        run: pip install UnityPy numpy

      - name: 2. Full Game Data Restoration
        run: |
          wget -q -O game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          unzip -o game.apk -d game_files

      - name: 3. The Omni-Assembler Script
        run: |
          cat << 'EOF' > omni_assembler.py
          import UnityPy
          import os
          import json

          # Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª Ø§Ù„ÙƒØ¨Ø±Ù‰ Ù„ÙƒÙ„ Ø´ÙŠØ¡
          grand_data = {
              "BERMUDA_WORLD": [],    # Ø§Ù„Ø®Ø±Ø§Ø¦Ø·ØŒ Ø§Ù„ØªØ¶Ø§Ø±ÙŠØ³ØŒ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª
              "SKINS_COLLECTION": [], # Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ØŒ Ø§Ù„Ø¬Ù„ÙˆØ¯ØŒ Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±
              "WEAPONS_PHYSICS": [],  # Ø§Ù„Ø£Ø³Ù„Ø­Ø© (Ù…Ø«Ù„ Ø§Ù„Ø®Ø·Ø§Ù)ØŒ Ø§Ù„Ø§Ø±ØªØ¯Ø§Ø¯ØŒ Ø§Ù„Ù…Ù‚Ø°ÙˆÙØ§Øª
              "CHARACTERS_DATA": [],  # Ø§Ù„Ø´Ø®ØµÙŠØ§ØªØŒ Ø§Ù„Ù‡ÙŠØª Ø¨ÙˆÙƒØ³ØŒ Ø§Ù„Ø¹Ø¸Ø§Ù…
              "GAME_LOGIC_RULES": []  # Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©ØŒ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«ØŒ Ø§Ù„Ù…Ù†Ø·Ù‚
          }

          # Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© (Tags)
          keywords = {
              "BERMUDA_WORLD": [b"Bermuda", b"Map", b"Terrain", b"StaticMesh", b"Collision"],
              "SKINS_COLLECTION": [b"Skin", b"Costume", b"Cloth", b"Bundle", b"Preview"],
              "WEAPONS_PHYSICS": [b"Weapon", b"Gun", b"Recoil", b"Bullet", b"Grappling", b"Hook"],
              "CHARACTERS_DATA": [b"Character", b"Hero", b"Skill", b"Avatar", b"Hitbox"],
              "GAME_LOGIC_RULES": [b"Manager", b"System", b"Event", b"Config", b"Rule"]
          }

          print("ğŸ“¡ Executing Absolute Extraction: Scanning all game sectors...")

          for root, dirs, files in os.walk("game_files"):
              for file in files:
                  try:
                      env = UnityPy.load(os.path.join(root, file))
                      for obj in env.objects:
                          # Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù‡ÙŠØ§ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø®Ø§Ù…)
                          try:
                              payload = obj.read().read_typetree()
                          except:
                              payload = {"raw_hex": obj.get_raw_data().hex()}

                          search_area = str(payload).encode()
                          
                          # ØªØµÙ†ÙŠÙ ÙˆØ¯Ù…Ø¬ ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                          for category, keys in keywords.items():
                              if any(k in search_area for k in keys):
                                  grand_data[category].append(payload)
                                  break
                  except: continue

          # Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ù…Ù„ÙØ§Øª Ø¶Ø®Ù…Ø© (ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ù…Ù„Ù)
          os.makedirs("GRAND_AI_DATASET", exist_ok=True)
          for cat, content in grand_data.items():
              print(f"ğŸ’¾ Saving Archive: {cat} (Size: {len(content)} items)")
              with open(f"GRAND_AI_DATASET/{cat}.json", "w", encoding='utf-8') as f:
                  json.dump(content, f, ensure_ascii=False)

          print("âœ… Everything has been extracted and archived!")
          EOF
          python3 omni_assembler.py

      - name: 4. Export Global AI Biome
        uses: actions/upload-artifact@v4
        with:
          name: FF_COMPLETE_AI_DATASET
          path: GRAND_AI_DATASET/