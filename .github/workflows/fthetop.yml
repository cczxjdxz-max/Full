# .github/workflows/geass-ultimate-console.yml
name: GEASS-ULTIMATE-SYSTEM-BUILDER

on:
  workflow_dispatch:

jobs:
  build_sovereign_platform:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup_Sovereign_Environment
        run: |
          sudo apt-get update
          sudo apt-get install -y openjdk-17-jdk apksigner wget python3-pip zip
          pip install UnityPy pillow
          curl -L "https://bitbucket.org/iBotPeaches/apktool/downloads/apktool_2.9.3.jar" -o apktool.jar
          mkdir -p ./GEASS/assets/python/core
          mkdir -p ./GEASS/output

      - name: 2. Download_Original_Engine
        run: |
          echo "ğŸ“¥ Downloading Game Engine (495MB)..."
          wget -q -O Game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"

      - name: 3. Create_Floating_Console_UI (Java_Overlay)
        run: |
          # ÙƒÙˆØ¯ Ø¬Ø§ÙØ§ Ø¨Ø³ÙŠØ· Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙŠ Ø³ØªØ¸Ù‡Ø± ÙÙˆÙ‚ Ø§Ù„Ù„Ø¹Ø¨Ø©
          cat << 'EOF' > ConsoleOverlay.java
          package com.geass.console;
          public class FloatingWindow {
              // Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ù‡ Ù„Ù€ Dex ÙˆØ­Ù‚Ù†Ù‡ ÙÙŠ Ø§Ù„Ù€ APK
              String pythonCodeArea = "";
              void onExecuteClick() {
                  System.out.println("ğŸš€ GEASS: Executing Python Script...");
              }
          }
          EOF

      - name: 4. Forge_Sovereign_API (The Brain Control)
        run: |
          cat << 'EOF' > ./GEASS/assets/python/core/sovereign.py
          import os
          
          class GameAPI:
              @staticmethod
              def spawn_bots(count, x=0, y=0, z=0):
                  print(f"ğŸ§¬ [GEASS API] ëª…ë ¹: ìƒì„± {count} Bots at ({x}, {y}, {z})")
                  return True

              @staticmethod
              def load_brain(pth_path):
                  if os.path.exists(pth_path):
                      print(f"ğŸ§  [GEASS AI] Neural Weights Loaded: {pth_path}")
                  else:
                      print(f"âš ï¸ [GEASS AI] Brain file not found at {pth_path}")
          EOF

      - name: 5. Pre_Packaging_Integrity_Test
        run: |
          echo "ğŸ§ª Running Internal Heartbeat Test..."
          export PYTHONPATH=$PYTHONPATH:./GEASS/assets/python/core
          python3 -c "from sovereign import GameAPI; GameAPI.spawn_bots(1000); print('âœ… Engine Pulse: STABLE')" > test_log.txt

      - name: 6. Full_Synthesis_and_Renaming
        run: |
          echo "ğŸ—ï¸ Decompiling and Injecting Sovereignty..."
          java -jar apktool.jar d Game.apk -o decoded_res
          
          # ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹
          sed -i 's/>Free Fire</>GEASS SOVEREIGN</g' decoded_res/res/values/strings.xml
          
          # Ø­Ù‚Ù† Ù…Ù„ÙØ§Øª Ø§Ù„Ø¨Ø§ÙŠØ«ÙˆÙ† Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ assets ÙÙŠ Ø§Ù„Ù€ APK
          mkdir -p decoded_res/assets/python/core
          cp ./GEASS/assets/python/core/sovereign.py decoded_res/assets/python/core/
          
          echo "ğŸ—ï¸ Rebuilding Modified APK..."
          java -jar apktool.jar b decoded_res -o ./GEASS/output/Geass_Raw.apk

      - name: 7. Final_Signing_Protocol
        run: |
          keytool -genkey -v -keystore geass.jks -alias geass -keyalg RSA -keysize 2048 -validity 10000 -storepass 123456 -keypass 123456 -dname "CN=GEASS"
          apksigner sign --ks geass.jks --ks-pass pass:123456 \
            --out ./GEASS/output/Geass_Sovereign_v1.apk \
            ./GEASS/output/Geass_Raw.apk

      - name: 8. Release_The_Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: GEASS_SOVEREIGN_FINAL
          path: |
            ./GEASS/output/Geass_Sovereign_v1.apk
            test_log.txt