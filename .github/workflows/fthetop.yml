name: GIAS-TOTAL-AI-FEEDER-250

on:
  workflow_dispatch:

jobs:
  full_ingestion:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup Data Processing Core
        run: pip install UnityPy numpy Pillow

      - name: 2. Restore Global Game Assets
        run: |
          wget -q -O game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          unzip -o game.apk -d game_files

      - name: 3. The "Absolute Knowledge" Script (Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©)
        run: |
          cat << 'EOF' > absolute_extractor.py
          import UnityPy
          import os
          import json
          from PIL import Image

          # ØªØµÙ†ÙŠÙØ§Øª Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ù„ Ø§Ù„Ø¬Ø¨Ø§Ø±
          categories = {
              "SPATIAL_AWARENESS": [], # Ø®Ø±Ø§Ø¦Ø·ØŒ ÙƒÙˆÙ„ÙŠØ¯Ø±Ø²ØŒ ØªØ¶Ø§Ø±ÙŠØ³
              "COMBAT_GENOME": [],     # Ø£Ø³Ù„Ø­Ø©ØŒ Ø§Ø±ØªØ¯Ø§Ø¯ØŒ Ø³Ø±Ø¹Ø©ØŒ Ø®Ø·Ø§Ù
              "PHYSICS_LAWS": [],      # Ø¬Ø§Ø°Ø¨ÙŠØ©ØŒ Ø§Ø­ØªÙƒØ§ÙƒØŒ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒØ§ Ø§Ù„Ø¹Ø§Ù„Ù…
              "ENTITY_VULNERABILITY": [], # Ø´Ø®ØµÙŠØ§ØªØŒ Ù‡ÙŠØª Ø¨ÙˆÙƒØ³ØŒ Ø¹Ø¸Ø§Ù…
              "VISUAL_DICTIONARY": [], # Ø³ÙƒÙ†Ø§ØªØŒ Ø£ÙŠÙ‚ÙˆÙ†Ø§ØªØŒ Ø®Ø±Ø§Ø¦Ø· Ø­Ø±Ø§Ø±ÙŠØ©
              "LOGIC_DECISION_TREES": [] # ÙƒÙŠÙ ØªÙÙƒØ± Ø§Ù„Ù„Ø¹Ø¨Ø© (Ø£Ù†Ø¸Ù…Ø©ØŒ Ù‚ÙˆØ§Ù†ÙŠÙ†)
          }

          tags = {
              "SPATIAL_AWARENESS": [b"Bermuda", b"Map", b"Terrain", b"StaticMesh", b"Collision"],
              "COMBAT_GENOME": [b"Weapon", b"Gun", b"Recoil", b"Hook", b"Ammo", b"Bullet"],
              "PHYSICS_LAWS": [b"Physics", b"Gravity", b"Mass", b"Velocity"],
              "ENTITY_VULNERABILITY": [b"Character", b"Hero", b"Hitbox", b"Bone", b"Skeleton"],
              "VISUAL_DICTIONARY": [b"Skin", b"Bundle", b"Material", b"Texture"],
              "LOGIC_DECISION_TREES": [b"Manager", b"System", b"Config", b"Rule", b"Logic"]
          }

          print("ğŸ§¬ Extracting the Game's DNA for the High-IQ Agent...")

          for root, dirs, files in os.walk("game_files"):
              for file in files:
                  try:
                      env = UnityPy.load(os.path.join(root, file))
                      for obj in env.objects:
                          # Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©
                          try:
                              data = obj.read().read_typetree()
                          except:
                              data = {"f_id": file, "raw_hex": obj.get_raw_data().hex()[:1000]}
                          
                          # Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ø¯Ù…Ø¬
                          content_str = str(data).encode()
                          for cat, keys in tags.items():
                              if any(k in content_str for k in keys):
                                  categories[cat].append(data)
                                  break
                  except: continue

          # Ø¯Ù…Ø¬ ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ Ù…Ù„ÙØ§Øª Ø¹Ù…Ù„Ø§Ù‚Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„
          os.makedirs("ULTIMATE_AI_DATASET", exist_ok=True)
          for cat, content in categories.items():
              print(f"ğŸ’¾ Archiving {cat}: {len(content)} objects.")
              with open(f"ULTIMATE_AI_DATASET/{cat}.json", "w", encoding='utf-8') as f:
                  json.dump(content, f, ensure_ascii=False)
          
          print("âœ… All Game Secrets Extracted into ULTIMATE_AI_DATASET/")
          EOF
          python3 absolute_extractor.py

      - name: 4. Export Global Intelligence
        uses: actions/upload-artifact@v4
        with:
          name: HIGH_IQ_AI_KNOWLEDGE_BASE
          path: ULTIMATE_AI_DATASET/