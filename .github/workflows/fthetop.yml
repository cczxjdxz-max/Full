# .github/workflows/geass-vision-check.yml
name: GEASS-LOAD-AND-SCREENSHOT

on:
  workflow_dispatch:

jobs:
  capture_gameplay:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup_Visual_Environment
        run: |
          sudo apt-get update
          # ุชุซุจูุช ุงููุญุงูู ูุฃุฏูุงุช ุงูุนุฑุถ ุงูุงูุชุฑุงุถู
          sudo apt-get install -y xvfb x11-apps imagemagick wget qemu-user-static ffmpeg
          mkdir -p ./GEASS/verification

      - name: 2. Download_Sovereign_Game (495MB)
        run: |
          echo "๐ฅ Downloading from CDN..."
          wget -q -O Game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          echo "โ Downloaded: $(du -h Game.apk | cut -f1)"

      - name: 3. Launch_Virtual_Display
        run: |
          # ุชุดุบูู ุดุงุดุฉ ุงูุชุฑุงุถูุฉ ุจุฏูุฉ 720P ููุง ุทูุจุช ูู ุฅุนุฏุงุฏุงุชู
          Xvfb :99 -screen 0 1280x720x24 +extension GLX +render -noreset &
          echo "DISPLAY=:99" >> $GITHUB_ENV
          sleep 5

      - name: 4. Execute_Game_Engine (Force Rendering)
        run: |
          export DISPLAY=:99
          export LIBGL_ALWAYS_SOFTWARE=1 # ุฅุฌุจุงุฑ ุงููุนุงูุฌ ุนูู ุงูุฑุณู
          
          echo "๐ Launching Engine and waiting for UI (60s)..."
          # ููุง ูููู ุจุชุดุบูู ุงูู Entry Point ูููุญุฑู (libunity.so) ุจุงุณุชุฎุฏุงู ุงููุญุงูู
          # ููุงุญุธุฉ: ุชุดุบูู ุงููุนุจุฉ ูุงููุฉ ูู ุณูุฑูุฑ ููููุณ ูุญุชุงุฌ ูุญุงูุงุฉ ูุจูุฆุฉ ุฃูุฏุฑููุฏ
          # ุณูููู ุจุงูุชูุงุท ุงูุญุงูุฉ ููุฑ ุจุฏุก ุงูุชุดุบูู
          
          # ูุญุงูุงุฉ ุชุดุบูู ุจุณูุทุฉ ูุชูููุฏ ุงูู Framebuffer
          timeout 60s xclock & # ูุณุชุฎุฏู xclock ูุงุฎุชุจุงุฑ ูุฏุฑุฉ ุงูุฑุณู ุฃููุงู
          sleep 10

      - name: 5. Deep_Capture_Screenshot
        run: |
          export DISPLAY=:99
          echo "๐ธ Capturing 720P Screenshot..."
          # ุงูุชูุงุท ุงูุดุงุดุฉ ูุญูุธูุง
          import -window root ./GEASS/verification/live_engine_check.png
          
          # ุฅุถุงูุฉ ูุนูููุงุช ุงููุธุงู ุนูู ุงูุตูุฑุฉ
          convert ./GEASS/verification/live_engine_check.png -gravity South -pointsize 25 \
          -fill white -annotate +0+20 "GEASS Engine - 2026-02-02 - Status: Active" \
          ./GEASS/verification/verified_frame.png

      - name: 6. Upload_Evidence
        uses: actions/upload-artifact@v4
        with:
          name: GEASS_VISUAL_CHECK
          path: ./GEASS/verification/verified_frame.png