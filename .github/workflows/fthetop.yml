# .github/workflows/geass-asset-extractor.yml
name: GEASS-ASSET-VISION

on:
  workflow_dispatch:

jobs:
  extract_vision:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Setup_Sovereign_Tools
        run: |
          sudo apt-get update
          sudo apt-get install -y wget python3-pip
          # Ø£Ø¯Ø§Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ± Ù…Ù† Ù…Ù„ÙØ§Øª ÙŠÙˆÙ†ÙŠØªÙŠ (Ø§Ù„Ù€ OBB Ø§Ù„Ù…Ø¯Ù…Ø¬)
          pip install UnityPy 

      - name: 2. Download_Sovereign_Game (495MB)
        run: |
          wget -q -O Game.apk "https://dl.cdn.freefiremobile.com/live/package/FreeFire.apk"
          echo "âœ… Game Captured. Analyzing Assets..."

      - name: 3. Python_Asset_Ripper (The Eye of Geass)
        run: |
          cat << 'EOF' > rip_assets.py
          import UnityPy
          import os
          from PIL import Image

          def extract_first_image():
              apk = UnityPy.load("Game.apk")
              count = 0
              os.makedirs("./GEASS/extracted", exist_ok=True)
              
              # Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ù€ OBB Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© Ø¹Ù† ØµÙˆØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (UI)
              for obj in apk.objects:
                  if obj.type.name in ["Texture2D", "Sprite"]:
                      data = obj.read()
                      # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£ÙˆÙ„ 5 ØµÙˆØ± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…Ø­Ø±Ùƒ
                      if count < 5:
                          try:
                              img = data.image
                              img.save(f"./GEASS/extracted/vision_{count}.png")
                              print(f"ğŸ“¸ Extracted: {data.name}")
                              count += 1
                          except:
                              continue
              if count == 0:
                  print("âŒ No assets found in the root. Deep scanning OBB...")

          extract_first_image()
          EOF
          python3 rip_assets.py

      - name: 4. Upload_Visual_Evidence
        uses: actions/upload-artifact@v4
        with:
          name: GEASS_INTERNAL_VISION
          path: ./GEASS/extracted/